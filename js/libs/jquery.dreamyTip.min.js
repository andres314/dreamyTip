/**
 * @fileoverview DreamyTip v3.5 - jQuery tooltip widget
 * @author andres(at)dreamsiteweb.com (Andres Pi)
 * 
 * 2012 - dreamsiteweb.com
 * 
 * @license Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html 
 * 
 *
 * The usage is similar to any Pluing jQuery.
 * The only settings in the HTML is the title attribute
 * in the tag that will have the tooltip, which will
 * contain the text to display. 
 * You should include the plugin file, dreamytip.css and dreamytip.png
 *
 * The avaliable options are:
 *
 *  cursor: 'pointer', // pointer, help, default, etc. Add style cursor on the target
 *	textAlign: 'center', // center, left, right, justify
 *  offsetLeftAdd: 0, // add extra left offset
 *  offsetTopAdd: 0, // add extra top offset
 *  backgroundPosition: false, // String to set a different background position (ex. "30px", "5% 10px", "left top")
 *  fade:  0.9, // opacity of the tooltip
 *  startDelay: 0, // Add a delay time before the tooltip appear
 *  removeQueuedAnimation: false, //A Boolean indicating whether to remove queued animation as well on the show event.
 *  duration: 'medium', // duration of the animation
 *  easing: 'swing', //effect
 *  event:'click', // click, focus, blur & hover are allowed or none in case you want to trigger manually
 *  persistHover: false, // enable a tooltip to persist until the user clicks somewhere else on the page
 *  closeButton: true, //True for the "x" button in the tooltip
 *  closeButtonOnHover: false, //Force close button on hover
 *  closeWithClick:false, //True to close when you click the tooltip
 *  closeOnBlur:false, //True to close when the trigger element lose focus
 *  autoCloseAfter: false, // milliseconds to wait to auto close
 *  position:'top', // top, right, left, bottom
 *  fontSize: false, // Set a different font-size than the default on CSS
 *  msg:false, // String with the message
 *  callbackOnShow: function(){}, // Callback for appear function. Could be the name of the function or if you need pass params an object like this: {f:writeSomething,params:'callbackOnShow: the tooltip appear'}}
 *  callbackOnHide: function(){} // Callback for disappear function. Could be the name of the function or if you need pass params an object like this: {f:writeSomething,params:'callbackOnShow: the tooltip appear'}}
 **/
(function(d){var l=function(a,b,c){switch(b){case "left":a=Math.abs(c-a.dreamyTipElememt.outerWidth())-5;break;case "right":a=Math.abs(c+a.outerWidth())+5;break;default:a=Math.abs(c+a.outerWidth()/2-a.dreamyTipElememt.outerWidth()/2)}return a},h=function(a){var b=a.data("dreamyTip").opts,c=a.offset();a._isOpen=!0;a.dreamyTipElememt.children(".dreamyTipInner").html(a.data("dtMsg"));setTimeout(function(){a.dreamyTipElememt.css({top:"bottom"==b.position?c.top+b.offsetTopAdd+a.height():"left"==b.position||
"right"==b.position?c.top+b.offsetTopAdd+a.outerHeight()/2-a.dreamyTipElememt.outerHeight()/2:c.top+b.offsetTopAdd-a.dreamyTipElememt.outerHeight(),left:l(a,b.position,c.left+b.offsetLeftAdd),zIndex:1E4,display:"block"}).stop(b.removeQueuedAnimation).animate({opacity:b.fade},b.duration,b.easing);"object"==typeof b.callbackOnShow?b.callbackOnShow.f(b.callbackOnShow.params):b.callbackOnShow();b.autoCloseAfter&&setTimeout(function(){e(a)},b.autoCloseAfter)},b.startDelay)},e=function(a){a.data.that&&
(a=a.data.that);d("html").unbind(".dreamyTip"+a.data("dreamyTip").id);var b=a.data("dreamyTip").opts;a._isOpen=!1;a.dreamyTipElememt.animate({opacity:0},b.duration,b.easing,function(){d(this).css({zIndex:0,display:"none"});"object"==typeof b.callbackOnHide?b.callbackOnHide.f(b.callbackOnHide.params):b.callbackOnHide()})},j=function(a){console.log("createTip");var b=a.data("dreamyTip").id,c=a.data("dreamyTip").opts;c.closeButton&&("hover"!=c.event||c.closeButtonOnHover)?(d("body").append('<div class="dreamyTip dt-'+
c.position+'" id="dreamyTip'+b+'"><div class="dreamyTipBtn">x</div><div class="dreamyTipInner" style="text-align:'+c.textAlign+'"></div></div>'),d("#dreamyTip"+b+" .dreamyTipBtn").bind("click",function(){e(a)})):d("body").append('<div class="dreamyTip dt-'+c.position+'" id="dreamyTip'+b+'"><div class="dreamyTipInner" style="text-align:'+c.textAlign+'"></div></div>');a.dreamyTipElememt=d("#dreamyTip"+b);c.closeWithClick&&a.dreamyTipElememt.bind("click",function(){e(a)});c.fontSize&&a.dreamyTipElememt.css("font-size",
c.fontSize);c.backgroundPosition&&a.dreamyTipElememt.css("background-position",c.backgroundPosition)},g={init:function(a){return this.each(function(){var b=d.extend({},d.fn.dreamyTip.defaults,a),c=d(this);c.dreamyTipElememt=!1;c.css("cursor",b.cursor);var f=c.attr("title");void 0!=f?c.removeAttr("title"):f="";b.msg&&(f=b.msg);c.data("dtMsg",f);c.data("dreamyTip")||c.data("dreamyTip",{opts:b,id:(new Date).getTime()});c.bind(b.event+".dreamyTip",function(){c.dreamyTipElememt||j(c);var a=c.data("dreamyTip").opts;
c._isOpen?a.persistHover||e(c):""!=c.data("dtMsg")&&h(c);var a=c.data("dreamyTip"),b=a.id,f="blur"==a.opts.event;if(f)var g=0;var k=function(){c.dreamyTipElememt=d("#dreamyTip"+b);e(c)};d("html").bind("click.dreamyTip"+b,function(){f?0<g?k():g++:k()})});b.closeOnBlur&&c.bind("blur.dreamyTip",function(){e(c)});c.bind("click.dreamyTip",function(a){a.stopPropagation()});d("html").on("click.dreamyTip",".dreamyTip",function(a){a.stopPropagation()})})},destroy:function(){return this.each(function(){var a=
d(this),b=a.data("dreamyTip");d(this).unbind(".dreamyTip");d("#dreamyTip"+b.id).remove();a.removeData("dreamyTip")})},show:function(){return this.each(function(){var a=d(this);a.data("dreamyTip");"undefined"!=a.dreamyTipElememt&&j(a);""!=a.data("dtMsg")&&h(a)})},close:function(){return this.each(function(){var a=d(this),b=a.data("dreamyTip");a.dreamyTipElememt=d("#dreamyTip"+b.id);e(a)})}};d.fn.dreamyTip=function(a){if(g[a])return g[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"===
typeof a||!a)return g.init.apply(this,arguments);d.error("Method "+a+" does not exist on jQuery.dreamyTip")};d.fn.dreamyTip.defaults={cursor:"pointer",textAlign:"center",offsetLeftAdd:0,offsetTopAdd:0,backgroundPosition:!1,fade:0.9,startDelay:0,removeQueuedAnimation:!1,duration:"medium",easing:"swing",event:"click",persistHover:!1,closeButton:!0,closeButtonOnHover:!1,closeWithClick:!1,closeOnBlur:!1,autoCloseAfter:!1,position:"top",fontSize:!1,msg:!1,callbackOnShow:function(){},callbackOnHide:function(){}}})(jQuery);